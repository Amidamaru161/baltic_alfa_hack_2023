# Baltic Alfa Hack 2023 - команда "Имя"

## Требования

- Python 3.10

## Установка библиотек

Для установки необходимых библиотек выполните следующие шаги:

1. Создайте виртуальное окружение (рекомендуется):

   ```bash
   python3.10 -m venv myenv
   source myenv/bin/activate
   pip install -r requirements.txt

2. Откройте терминал в папке со скриптами и введите следующее:

   ```bash
   python train_model.py # Запускает обучение модели на данных (path/data/input/train..)
   python predict_data.py # Предсказывание моделью (path/models) значений на данных (path/data/input/test..)

3. Чтобы проверить нашу модель, необходимо:

   Скачать модель с hugging face:
   ```bash
   https://huggingface.co/YourGodAmaterasu/alfahack_model/resolve/main/gluon_model.tar.gz
   ```
   Положить архив в (path/models) и запустить скрипт:
   ```bash
   python unzip_model.py
   
## Проект имеет следующюю струткру 
- `data/`: Директория, которая содержит входные и выходные данные проекта.
  - `input/`: Директория с входными данными.
    - `test.parquet`: Файл с тестовыми данными в формате Parquet.
    - `train_part1.parquet`: Файл с частью обучающих данных 1 в формате Parquet.
    - `train_part2.parquet`: Файл с частью обучающих данных 2 в формате Parquet.
  - `output/`: Директория с выходными данными.
    - `predictions.csv`: Файл с предсказаниями в формате CSV.
- `models/`: Директория для сохранения моделей машинного обучения.
  - `.gitkeep`: Файл для сохранения пустой директории в системе контроля версий Git.
- `notebooks/`: Директория с Jupyter-ноутбуками.
  - `.gitkeep`: Файл для сохранения пустой директории в системе контроля версий Git.
  - `gluon_baseline.ipynb`: Jupyter-ноутбук с базовым решением, использующим Gluon.
  - `optuna_ensamble_baseline.ipynb`: Jupyter-ноутбук с базовым решением, использующим Optuna и ансамблирование моделей.
- `src/`: Директория с исходными кодами проекта.
  - `predict_data.py`: Скрипт для предсказания данных.
  - `train_model.py`: Скрипт для обучения модели.
  - `unzip_model.py`: Скрипт для разархивации модели.
- `.gitignore`: Файл, указывающий, какие файлы и директории должны быть проигнорированы системой контроля версий Git.



###/src/predict_data.py

- 1.Определяет путь к данным для предсказаний относительно расположения скрипта.
- 2.Загружает данные для предсказаний из файла test.parquet с использованием TabularDataset.
- 3.Определяет путь для сохранения предсказаний.
- 4.Определяет путь к последней модели из папки models.
- 5.Загружает обученную модель с помощью TabularPredictor.load.
- 6.Выполняет предсказания на тестовых данных с помощью predict_proba.
- 7.Сохраняет предсказания в CSV-файле predictions.csv, включая столбцы 'id' и 'score'.

###/src/train_model.py

- 1.Определяет путь к данным для обучения относительно расположения скрипта.
- 2.Загружает данные для обучения из файлов train_part1.parquet и train_part2.parquet с использованием TabularDataset. Он также удаляет столбцы 'target_1' и 'target_2'.
- 3.Объединяет данные в один DataFrame.
- 4.Определяет путь для сохранения модели с использованием текущей даты и времени в качестве префикса модели.
- 5.Обучает модель с помощью TabularPredictor.fit, указывая целевую переменную как'total_target' и метрику оценки как 'roc_auc'.


##src/unzip_model.py
- 1.Определяет путь к папке с моделями относительно расположения скрипта.
- 2.Определяет имя архива модели.
- 3.Формирует полный путь к архиву модели.
- 4.Распаковывает архив с использованием tarfile.open и сохраняет содержимое в папку моделей.
- 5.Удаляет архив модели.


## Запуск из docker
```sh
docker build -t filedock 
```
